---
title: "TP1"
author: "Cristian Salinas"
date: "2023-10-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("readxl")
library('tidyverse')
library('here')
```

```{r}
library(readxl)#lectura
library(dplyr) #manipulacion de datos
library(kableExtra) #tablas
library(ggplot2) #graficos
library(tidyverse) #manipulacion de datos
library(ggpubr) #para juntar
library(ggforce) # grafico de violin y jitter
library(GGally) # ggpairs
library(corrplot) # para correlogramas
```



```{r}
here::here()
```

```{r}
recepcionistas <- read_excel("recepcionistas.xls")
```

```{r}
colnames(recepcionistas) <- gsub(" ", "", colnames(recepcionistas))
```

```{r}
glimpse(recepcionistas)
```

```{r}
recepcionistas %>% head()
```

Se transforman los datos para responder las preguntas del trabajo practico de una manera mas practica.

```{r}
recep_tidy = recepcionistas %>%  pivot_longer(cols = 2:7, # Columnas que deseas transformar
               names_to = "Variable",   # Nombre de la nueva columna de variables
               values_to = "Puntuacion") %>% 
  separate_wider_delim(Variable, delim = ".", names = c("rubro", "juez")) %>% 
  mutate(candidatos = as.factor(candidatos),
         rubro = as.factor(rubro),
         juez = as.factor(juez))
```

```{r}
recep_tidy %>% head(5)
```

Calcule en promedio por juez de cada una de las aspirantes. ¿Cuál le parece que seleccionaría cada uno de ellos? ¿Existe coincidencia?

Se calcula el promedio de puntaje por juez y candidata para cada juez.

```{r}
recep_tidy %>% 
  group_by(juez, candidatos) %>% 
  summarise(promedio = mean(Puntuacion)) %>% 
  pivot_wider(names_from = juez, values_from = promedio)
```

```{r}
recep_tidy %>% 
  group_by(juez, candidatos) %>% 
  summarise(promedio = mean(Puntuacion)) %>% 
  filter(juez =="juez1") %>% 
  arrange(-promedio)

recep_tidy %>% 
  group_by(juez, candidatos) %>% 
  summarise(promedio = mean(Puntuacion)) %>% 
  filter(juez =="juez2") %>% 
  arrange(-promedio)

```

Calcule el promedio de cada una de las aspirantes tomando en cuenta todos los rubros y ambos jueces.

```{r}
recep_tidy %>% 
  group_by(candidatos) %>% 
  summarise(promedio = mean(Puntuacion)) %>% 
  arrange(-promedio)
```

Transformar las puntuaciones observadas de modo tal que cada una de las seis variables tenga media 0 y dispersión 1. ¿Cuál sería el objetivo de esta transformación?

```{r}
recep_tidy %>% 
  pivot_wider(names_from = c(rubro, juez), values_from = Puntuacion) %>% 
  mutate(cord_juez1 = scale(cord_juez1),
         pres_juez1 = scale(pres_juez1),
         idiom_juez1 = scale(idiom_juez1),
         cord_juez2 = scale(cord_juez2),
         pres_juez2 = scale(pres_juez2),
         idiom_juez2 = scale(idiom_juez2))
```

```{r}
cbind(recepcionistas$candidatos, data.frame(scale(recepcionistas[,2:7])) )
```

```{r}
recep_tidy %>% 
  group_by(juez, candidatos) %>% 
  summarise(promedio = mean(Puntuacion)) %>% 
  pivot_wider(names_from = juez, values_from = promedio) %>% 
  mutate(juez1 = scale(juez1), 
         juez2 = scale(juez2))
```


```{r}
cbind(recepcionistas$candidatos, recepcionistas[, c(1, 5:7)] %>% mutate(promedio_J2 = (recepcionistas$cord.juez2+recepcionistas$pres.juez2+recepcionistas$idiom.juez2)/3)  %>% select(promedio_J2) %>% scale() %>% data.frame() )

```

```{r}
cbind(recepcionistas$candidatos, recepcionistas[, c(1, 2:4)] %>% 
        mutate(promedio_J1 = (recepcionistas$cord.juez1+recepcionistas$pres.juez1+recepcionistas$idiom.juez1)/3) %>%
        select(promedio_J1) %>% 
        scale() %>% 
        data.frame())
```

```{r}
recep_tidy %>% ggplot(aes(x=Puntuacion, y = candidatos, fill = juez)) + 
  geom_boxplot() 
```

```{r}
ggplot(recep_tidy,aes(x=rubro,y=Puntuacion,color=candidatos))+
  geom_line(aes(group =candidatos))+ 
  labs(title = "juez 1") + 
  theme(axis.text.x  = element_text(angle=90))+
  facet_row(~juez)
```
## Ejercicio 2

```{r}
internet = read_excel("Internet2013.xls")
```

```{r}
scale(internet$Temperatura)
```


Clasificar las variables de la base. Para las variables numéricas construir un gráfico de coordenadas paralelas.
```{r}
internet %>% select(Nacionalidad,
                    Edad,
                    Estatura,
                    Uso,
                    Temperatura,
                    Autos,
                    Cigarrillos) %>% 
  mutate_if(is.numeric, ~scale(.)) %>% 
  pivot_longer(names_to ="Variable", values_to = 'Valor', cols = 2:7) %>% 
  ggplot(aes(x=Valor, y= Variable, fill = Nacionalidad))+
  geom_boxplot(alpha=0.5)
````

Construir la tabla de frecuencias de la variable sexo. ¿Hay algún valor que llame la atención? ¿Qué tipo de error considera que es?

```{r}
unique(internet$Sexo)
```


```{r}
table(internet$Sexo)
```

```{r}
internet %>% ggplot(aes(x=Sexo))+geom_bar()
```

Ordenar los datos por la variable Edad. ¿Encontró algún valor extraño? ¿Qué tipo de error puede ser? item Construir la tabla de frecuencias de la variable Sitio. ¿Encuentra algún valor que le llame la atención? ¿Qué tipo de error puede ser?
```{r}
internet$Edad %>% summary()
```

```{r}
internet %>% arrange(Edad) %>% select(Edad)
```
```{r}
internet %>% filter(Edad >=0)
```


```{r}
table(internet$Sitio)
```


```{r}
k = 10 * log(nrow(internet))#dixo
k2 = 1 + 3.322 * log(nrow(internet))#strudges
```

```{r}
internet %>% select(Temperatura) %>% 
  mutate(intervalos = cut(Temperatura, breaks  = k2)) %>% 
  group_by(intervalos) %>%
  summarise(fi = n()) %>%
  mutate(f = fi / sum(fi) * 100)
```
```{r}
internet %>% select(Temperatura) %>% ggplot(aes(x=Temperatura))+
  geom_histogram(bins = round(k2), fill = 'blue', color='black')
```
```{r}
internet$Autos %>% summary()
```


```{r}
internet %>% select(Autos) %>% ggplot(aes(x=Autos))+
  geom_boxplot(fill = 'blue', color='black')
```
```{r}
cut(internet$Autos, breaks  = k)
```


```{r}
internet %>% select(Autos) %>% 
  mutate(intervalos = cut(Autos, breaks  = k)) %>% 
  group_by(intervalos) %>%
  summarise(fi = n()) %>%
  mutate(f = fi / sum(fi) * 100)
```

```{r}
internet %>% summary()
```

g

```{r}
internet %>% select(Nacionalidad,
                    Edad,
                    Estatura,
                    Uso,
                    Temperatura,
                    Autos,
                    Cigarrillos) %>% 
  mutate_if(is.numeric, ~scale(.)) %>% 
  pivot_longer(names_to ="Variable", values_to = 'Valor', cols = 2:7) %>% 
  ggplot(aes(x=Valor, y= Variable))+
  geom_boxplot(alpha=0.5)
```


```{r}
ggplot(internet, aes(x=Estatura)) + geom_boxplot()
```

```{r}
q3 = quantile(internet$Estatura, 0.75)
q1 = quantile(internet$Estatura, 0.25)
riq = IQR(internet$Estatura)
```

```{r}
#1.5 veces es salvaje
#3 veces es severo

li_salvaje = q1- 1.5 * riq
ls_salvaje = q3 +1.5 * riq 

li_severo = q1- 3 * riq
ls_severo = q3 +3 * riq 

```


```{r}
internet %>% select(Estatura) %>% 
  mutate(salvaje = (Estatura < li_salvaje | Estatura > ls_salvaje),
         severo = (Estatura < li_severo | Estatura > ls_severo) ) %>% 
  count(severo, salvaje)

```


